# Converte o objeto PSObject em JSON e, em seguida, converte em UTF-8
$jsonContent = $data | ConvertTo-Json
$utf8Bytes = [System.Text.Encoding]::UTF8.GetBytes($jsonContent)
$utf8String = [System.Text.Encoding]::UTF8.GetString($utf8Bytes)

# Retorna o JSON em UTF-8
$utf8String


$encodedJson = $Test | ConvertTo-Json -Depth 100 | Out-String -Stream | ForEach-Object { [System.Text.Encoding]::UTF8.GetBytes($_) }
 
# Concatena os bytes do JSON
$jsonBytes = [byte[]] @()
$encodedJson | ForEach-Object { $jsonBytes += $_ }
 
# Retorna o JSON com a codificação UTF-8
return [System.Text.Encoding]::UTF8.GetString($jsonBytes)
